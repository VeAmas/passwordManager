<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
    <script>
        var hexcase=0;var b64pad="";var chrsz=8;window.hex_md5=function(r){return binl2hex(core_md5(str2binl(r),r.length*chrsz))};window.b64_md5=function(r){return binl2b64(core_md5(str2binl(r),r.length*chrsz))};window.str_md5=function(r){return binl2str(core_md5(str2binl(r),r.length*chrsz))};window.hex_hmac_md5=function(r,d){return binl2hex(core_hmac_md5(r,d))};window.b64_hmac_md5=function(r,d){return binl2b64(core_hmac_md5(r,d))};window.str_hmac_md5=function(r,d){return binl2str(core_hmac_md5(r,d))};function md5_vm_test(){return hex_md5("abc")=="900150983cd24fb0d6963f7d28e17f72"}function core_md5(r,d){r[d>>5]|=128<<d%32;r[(d+64>>>9<<4)+14]=d;var _=1732584193;var m=-271733879;var n=-1732584194;var i=271733878;for(var h=0;h<r.length;h+=16){var f=_;var a=m;var t=n;var e=i;_=md5_ff(_,m,n,i,r[h+0],7,-680876936);i=md5_ff(i,_,m,n,r[h+1],12,-389564586);n=md5_ff(n,i,_,m,r[h+2],17,606105819);m=md5_ff(m,n,i,_,r[h+3],22,-1044525330);_=md5_ff(_,m,n,i,r[h+4],7,-176418897);i=md5_ff(i,_,m,n,r[h+5],12,1200080426);n=md5_ff(n,i,_,m,r[h+6],17,-1473231341);m=md5_ff(m,n,i,_,r[h+7],22,-45705983);_=md5_ff(_,m,n,i,r[h+8],7,1770035416);i=md5_ff(i,_,m,n,r[h+9],12,-1958414417);n=md5_ff(n,i,_,m,r[h+10],17,-42063);m=md5_ff(m,n,i,_,r[h+11],22,-1990404162);_=md5_ff(_,m,n,i,r[h+12],7,1804603682);i=md5_ff(i,_,m,n,r[h+13],12,-40341101);n=md5_ff(n,i,_,m,r[h+14],17,-1502002290);m=md5_ff(m,n,i,_,r[h+15],22,1236535329);_=md5_gg(_,m,n,i,r[h+1],5,-165796510);i=md5_gg(i,_,m,n,r[h+6],9,-1069501632);n=md5_gg(n,i,_,m,r[h+11],14,643717713);m=md5_gg(m,n,i,_,r[h+0],20,-373897302);_=md5_gg(_,m,n,i,r[h+5],5,-701558691);i=md5_gg(i,_,m,n,r[h+10],9,38016083);n=md5_gg(n,i,_,m,r[h+15],14,-660478335);m=md5_gg(m,n,i,_,r[h+4],20,-405537848);_=md5_gg(_,m,n,i,r[h+9],5,568446438);i=md5_gg(i,_,m,n,r[h+14],9,-1019803690);n=md5_gg(n,i,_,m,r[h+3],14,-187363961);m=md5_gg(m,n,i,_,r[h+8],20,1163531501);_=md5_gg(_,m,n,i,r[h+13],5,-1444681467);i=md5_gg(i,_,m,n,r[h+2],9,-51403784);n=md5_gg(n,i,_,m,r[h+7],14,1735328473);m=md5_gg(m,n,i,_,r[h+12],20,-1926607734);_=md5_hh(_,m,n,i,r[h+5],4,-378558);i=md5_hh(i,_,m,n,r[h+8],11,-2022574463);n=md5_hh(n,i,_,m,r[h+11],16,1839030562);m=md5_hh(m,n,i,_,r[h+14],23,-35309556);_=md5_hh(_,m,n,i,r[h+1],4,-1530992060);i=md5_hh(i,_,m,n,r[h+4],11,1272893353);n=md5_hh(n,i,_,m,r[h+7],16,-155497632);m=md5_hh(m,n,i,_,r[h+10],23,-1094730640);_=md5_hh(_,m,n,i,r[h+13],4,681279174);i=md5_hh(i,_,m,n,r[h+0],11,-358537222);n=md5_hh(n,i,_,m,r[h+3],16,-722521979);m=md5_hh(m,n,i,_,r[h+6],23,76029189);_=md5_hh(_,m,n,i,r[h+9],4,-640364487);i=md5_hh(i,_,m,n,r[h+12],11,-421815835);n=md5_hh(n,i,_,m,r[h+15],16,530742520);m=md5_hh(m,n,i,_,r[h+2],23,-995338651);_=md5_ii(_,m,n,i,r[h+0],6,-198630844);i=md5_ii(i,_,m,n,r[h+7],10,1126891415);n=md5_ii(n,i,_,m,r[h+14],15,-1416354905);m=md5_ii(m,n,i,_,r[h+5],21,-57434055);_=md5_ii(_,m,n,i,r[h+12],6,1700485571);i=md5_ii(i,_,m,n,r[h+3],10,-1894986606);n=md5_ii(n,i,_,m,r[h+10],15,-1051523);m=md5_ii(m,n,i,_,r[h+1],21,-2054922799);_=md5_ii(_,m,n,i,r[h+8],6,1873313359);i=md5_ii(i,_,m,n,r[h+15],10,-30611744);n=md5_ii(n,i,_,m,r[h+6],15,-1560198380);m=md5_ii(m,n,i,_,r[h+13],21,1309151649);_=md5_ii(_,m,n,i,r[h+4],6,-145523070);i=md5_ii(i,_,m,n,r[h+11],10,-1120210379);n=md5_ii(n,i,_,m,r[h+2],15,718787259);m=md5_ii(m,n,i,_,r[h+9],21,-343485551);_=safe_add(_,f);m=safe_add(m,a);n=safe_add(n,t);i=safe_add(i,e)}return Array(_,m,n,i)}function md5_cmn(r,d,_,m,n,i){return safe_add(bit_rol(safe_add(safe_add(d,r),safe_add(m,i)),n),_)}function md5_ff(r,d,_,m,n,i,h){return md5_cmn(d&_|~d&m,r,d,n,i,h)}function md5_gg(r,d,_,m,n,i,h){return md5_cmn(d&m|_&~m,r,d,n,i,h)}function md5_hh(r,d,_,m,n,i,h){return md5_cmn(d^_^m,r,d,n,i,h)}function md5_ii(r,d,_,m,n,i,h){return md5_cmn(_^(d|~m),r,d,n,i,h)}function core_hmac_md5(r,d){var _=str2binl(r);if(_.length>16)_=core_md5(_,r.length*chrsz);var m=Array(16),n=Array(16);for(var i=0;i<16;i++){m[i]=_[i]^909522486;n[i]=_[i]^1549556828}var h=core_md5(m.concat(str2binl(d)),512+d.length*chrsz);return core_md5(n.concat(h),512+128)}function safe_add(r,d){var _=(r&65535)+(d&65535);var m=(r>>16)+(d>>16)+(_>>16);return m<<16|_&65535}function bit_rol(r,d){return r<<d|r>>>32-d}function str2binl(r){var d=Array();var _=(1<<chrsz)-1;for(var m=0;m<r.length*chrsz;m+=chrsz)d[m>>5]|=(r.charCodeAt(m/chrsz)&_)<<m%32;return d}function binl2str(r){var d="";var _=(1<<chrsz)-1;for(var m=0;m<r.length*32;m+=chrsz)d+=String.fromCharCode(r[m>>5]>>>m%32&_);return d}function binl2hex(r){var d=hexcase?"0123456789ABCDEF":"0123456789abcdef";var _="";for(var m=0;m<r.length*4;m++){_+=d.charAt(r[m>>2]>>m%4*8+4&15)+d.charAt(r[m>>2]>>m%4*8&15)}return _}function binl2b64(r){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var _="";for(var m=0;m<r.length*4;m+=3){var n=(r[m>>2]>>8*(m%4)&255)<<16|(r[m+1>>2]>>8*((m+1)%4)&255)<<8|r[m+2>>2]>>8*((m+2)%4)&255;for(var i=0;i<4;i++){if(m*8+i*6>r.length*32)_+=b64pad;else _+=d.charAt(n>>6*(3-i)&63)}}return _}
    </script>
    <script>
        function encrypt() {

            const alphabet = [ 
              '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 
              'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'm', 'n', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z',
              'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'J', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'
            ]

            function convert (str) {                
                let hex = hex_md5(str)
                let res = ''
                let specialTokenPos = parseInt(hex.substr(0, 2), 16) % 12;
                for (let i = 0; i < 12; i++) {
                    let index = parseInt(hex.substr(i * 2, 2), 16) % alphabet.length
                    res += alphabet[index]
                }
                if (str[0] === '_') {
                    res = res.substr(0, specialTokenPos) + '_' + res.substr(specialTokenPos + 1)
                }
                return res
            }

            var source = document.querySelector('#source').value;
            
            source = JSON.parse(source);
            var result = source.map((v) => {
                return {
                    key: v.key,
                    value: convert(v.key)
                }
            })
            document.querySelector('#result').innerText = JSON.stringify(result, 0, 4);

        }
    </script>

    <textarea id="source" name="" id="" cols="30" rows="10"></textarea>
    <button onclick="encrypt()">加密</button>
    <div id="result"></div>
</body>
</html>